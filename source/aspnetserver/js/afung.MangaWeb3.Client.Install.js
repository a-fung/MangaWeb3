// afung.MangaWeb3.Client.Install.js
(function(){
Type.registerNamespace('afung.MangaWeb3.Client.Install');afung.MangaWeb3.Client.Install.InstallApp=function(){afung.MangaWeb3.Client.Install.InstallApp.initializeBase(this);}
afung.MangaWeb3.Client.Install.InstallApp.prototype={startStage2:function(){afung.MangaWeb3.Client.Template.templates[afung.MangaWeb3.Client.Template.templates.length]='install';afung.MangaWeb3.Client.Template.templateIds['install']=['installing-modal','install-mudraw-error','install-pdfdraw-error','install-pdfinfo-error','install-pdfinfoexe-error','install-rar-error','install-zip-error','install-sevenzip-error','install-gd-error','install-mysql-connect-error','install-mysql-error','install-module'];afung.MangaWeb3.Client.Request.endpoint='InstallAjax';afung.MangaWeb3.Client.Install.InstallApp.callBaseMethod(this, 'startStage2');},loadFirstModule:function(){new afung.MangaWeb3.Client.Install.Module.InstallModule();}}
Type.registerNamespace('afung.MangaWeb3.Client.Install.Modal');afung.MangaWeb3.Client.Install.Modal.InstallingModal=function(request){afung.MangaWeb3.Client.Install.Modal.InstallingModal.initializeBase(this,['install','installing-modal']);this.$1_0=request;}
afung.MangaWeb3.Client.Install.Modal.InstallingModal.prototype={$1_0:null,initialize:function(){this.showStatic();afung.MangaWeb3.Client.Request.send(this.$1_0,ss.Delegate.create(this,this.$1_1));},$1_1:function(){}}
Type.registerNamespace('afung.MangaWeb3.Client.Install.Module');afung.MangaWeb3.Client.Install.Module.InstallModule=function(){afung.MangaWeb3.Client.Install.Module.InstallModule.initializeBase(this,['install','install-module']);}
afung.MangaWeb3.Client.Install.Module.InstallModule.prototype={$1_0:false,get_$1_1:function(){return this.$1_0;},set_$1_1:function($p0){if($p0){$('#install-zip-checkbox',this.attachedObject).removeAttr(afung.MangaWeb3.Client.HtmlConstants.attributeDisabled);}else{$('#install-zip-checkbox',this.attachedObject).attr(afung.MangaWeb3.Client.HtmlConstants.attributeDisabled,afung.MangaWeb3.Client.HtmlConstants.attributeDisabled).removeAttr(afung.MangaWeb3.Client.HtmlConstants.attributeChecked);}this.$1_0=$p0;return $p0;},$1_2:false,get_$1_3:function(){return this.$1_2;},set_$1_3:function($p0){if($p0){$('#install-rar-checkbox',this.attachedObject).removeAttr(afung.MangaWeb3.Client.HtmlConstants.attributeDisabled);}else{$('#install-rar-checkbox',this.attachedObject).attr(afung.MangaWeb3.Client.HtmlConstants.attributeDisabled,afung.MangaWeb3.Client.HtmlConstants.attributeDisabled).removeAttr(afung.MangaWeb3.Client.HtmlConstants.attributeChecked);}this.$1_2=$p0;return $p0;},$1_4:false,get_$1_5:function(){return this.$1_4;},set_$1_5:function($p0){if($p0){$('#install-pdf-checkbox',this.attachedObject).removeAttr(afung.MangaWeb3.Client.HtmlConstants.attributeDisabled);}else{$('#install-pdf-checkbox',this.attachedObject).attr(afung.MangaWeb3.Client.HtmlConstants.attributeDisabled,afung.MangaWeb3.Client.HtmlConstants.attributeDisabled).removeAttr(afung.MangaWeb3.Client.HtmlConstants.attributeChecked);}this.$1_4=$p0;return $p0;},$1_6:false,initialize:function(){$('#install-form').hide();afung.MangaWeb3.Client.Request.send(new afung.MangaWeb3.Common.PreInstallCheckRequest(),ss.Delegate.create(this,this.$1_7));},$1_7:function($p0){if($p0.installed){return;}$('#install-preinstall-check').hide();$('#install-form').show();$('#install-mysql-check').hide();$('#install-mysql-loading').hide();$('#install-sevenzip-check').hide();$('#install-sevenzip-loading').hide();$('#install-pdfinfoexe-check').hide();$('#install-pdfinfoexe-loading').hide();$('#install-mudraw-check').hide();$('#install-mudraw-loading').hide();$('#install-admin-username-check').hide();$('#install-admin-password-check').hide();$('#install-admin-password2-check').hide();if(afung.MangaWeb3.Client.Environment.serverType===afung.MangaWeb3.Client.ServerType.aspNet){this.set_$1_1(this.set_$1_3(this.set_$1_5(false)));this.$1_6=true;$('#install-sevenzip-dll').change(ss.Delegate.create(this,this.$1_1D));$('#install-pdfinfoexe').change(ss.Delegate.create(this,this.$1_1D));$('#install-mudraw-exe').change(ss.Delegate.create(this,this.$1_1D));}else{$('#install-sevenzip').hide();$('#install-pdfinfoexe').hide();$('#install-mudraw').hide();this.set_$1_1($p0.zip);this.set_$1_3($p0.rar);this.set_$1_5($p0.pdfinfo&&$p0.pdfdraw);this.$1_6=$p0.mySql&&$p0.gd;if(!$p0.mySql){afung.MangaWeb3.Client.Template.get('install','install-mysql-error').appendTo($('#mysql-error-area'));}if(!$p0.gd){afung.MangaWeb3.Client.Template.get('install','install-gd-error').appendTo($('#gd-error-area'));}if(!$p0.zip){afung.MangaWeb3.Client.Template.get('install','install-zip-error').appendTo($('#zip-error-area'));}if(!$p0.rar){afung.MangaWeb3.Client.Template.get('install','install-rar-error').appendTo($('#rar-error-area'));}if(!$p0.pdfinfo){afung.MangaWeb3.Client.Template.get('install','install-pdfinfo-error').appendTo($('#pdfinfo-error-area'));}if(!$p0.pdfdraw){afung.MangaWeb3.Client.Template.get('install','install-pdfdraw-error').appendTo($('#mudraw-error-area'));}}$('#install-mysql-check-setting').click(ss.Delegate.create(this,this.$1_D));$('#install-mysql-server').change(ss.Delegate.create(this,this.$1_C));$('#install-mysql-port').change(ss.Delegate.create(this,this.$1_C));$('#install-mysql-username').change(ss.Delegate.create(this,this.$1_C));$('#install-mysql-password').change(ss.Delegate.create(this,this.$1_C));$('#install-mysql-database').change(ss.Delegate.create(this,this.$1_C));$('#install-admin-username').change(ss.Delegate.create(this,this.$1_20));$('#install-admin-password').change(ss.Delegate.create(this,this.$1_21));$('#install-admin-password2').change(ss.Delegate.create(this,this.$1_22));$('#install-submit-btn').click(ss.Delegate.create(this,this.$1_23));},$1_8:false,get_$1_9:function(){return this.$1_8;},set_$1_9:function($p0){this.$1_8=$p0;if($p0){$('#install-mysql-loading').show();}else{$('#install-mysql-loading').hide();}return $p0;},$1_A:false,get_$1_B:function(){return this.$1_A;},set_$1_B:function($p0){this.$1_A=$p0;if($p0){$('#install-mysql-check').show();}else{$('#install-mysql-check').hide();}return $p0;},$1_C:function($p0){this.set_$1_B(false);},$1_D:function($p0){if(this.get_$1_9()){return;}var $0=$('#install-mysql-server').val();var $1=$('#install-mysql-port').val();var $2=$('#install-mysql-username').val();var $3=$('#install-mysql-password').val();var $4=$('#install-mysql-database').val();if(String.isNullOrEmpty($0)||String.isNullOrEmpty($1)||String.isNullOrEmpty($2)||String.isNullOrEmpty($4)){return;}var $5=parseInt($1,10);var $6=new afung.MangaWeb3.Common.CheckMySqlSettingRequest();$6.server=$0;$6.port=$5;$6.username=$2;$6.password=$3;$6.database=$4;$('#install-mysql-connect-error').remove();this.set_$1_9(true);this.set_$1_B(false);afung.MangaWeb3.Client.Request.send($6,ss.Delegate.create(this,this.$1_E),ss.Delegate.create(this,this.$1_F));},$1_E:function($p0){this.set_$1_9(false);this.set_$1_B($p0.pass);if(!$p0.pass){this.$1_F();}},$1_F:function(){this.set_$1_B(this.set_$1_9(false));afung.MangaWeb3.Client.Template.get('install','install-mysql-connect-error').appendTo($('#mysql-error-area'));},$1_10:false,get_$1_11:function(){return this.$1_10;},set_$1_11:function($p0){this.$1_10=$p0;if($p0){$('#install-sevenzip-loading').show();$('#install-sevenzip-dll').attr(afung.MangaWeb3.Client.HtmlConstants.attributeDisabled,afung.MangaWeb3.Client.HtmlConstants.attributeDisabled);}else{$('#install-sevenzip-loading').hide();$('#install-sevenzip-dll').removeAttr(afung.MangaWeb3.Client.HtmlConstants.attributeDisabled);}return $p0;},$1_12:false,get_$1_13:function(){return this.$1_12;},set_$1_13:function($p0){this.set_$1_1(this.set_$1_3(this.$1_12=$p0));if($p0){$('#install-sevenzip-check').show();}else{$('#install-sevenzip-check').hide();}return $p0;},$1_14:false,get_$1_15:function(){return this.$1_14;},set_$1_15:function($p0){this.$1_14=$p0;if($p0){$('#install-pdfinfoexe-loading').show();$('#install-pdfinfoexe').attr(afung.MangaWeb3.Client.HtmlConstants.attributeDisabled,afung.MangaWeb3.Client.HtmlConstants.attributeDisabled);}else{$('#install-pdfinfoexe-loading').hide();$('#install-pdfinfoexe').removeAttr(afung.MangaWeb3.Client.HtmlConstants.attributeDisabled);}return $p0;},$1_16:false,get_$1_17:function(){return this.$1_16;},set_$1_17:function($p0){this.$1_16=$p0;this.set_$1_5($p0&&this.get_$1_1B());if($p0){$('#install-pdfinfoexe-check').show();}else{$('#install-pdfinfoexe-check').hide();}return $p0;},$1_18:false,get_$1_19:function(){return this.$1_18;},set_$1_19:function($p0){this.$1_18=$p0;if($p0){$('#install-mudraw-loading').show();$('#install-mudraw-exe').attr(afung.MangaWeb3.Client.HtmlConstants.attributeDisabled,afung.MangaWeb3.Client.HtmlConstants.attributeDisabled);}else{$('#install-mudraw-loading').hide();$('#install-mudraw-exe').removeAttr(afung.MangaWeb3.Client.HtmlConstants.attributeDisabled);}return $p0;},$1_1A:false,get_$1_1B:function(){return this.$1_1A;},set_$1_1B:function($p0){this.$1_1A=$p0;this.set_$1_5($p0&&this.get_$1_17());if($p0){$('#install-mudraw-check').show();}else{$('#install-mudraw-check').hide();}return $p0;},$1_1C:0,$1_1D:function($p0){var $0=$($p0.target);var $1=$0.attr(afung.MangaWeb3.Client.HtmlConstants.attributeId);var $2=false;switch($1){case 'install-sevenzip-dll':$2=this.get_$1_11();break;case 'install-pdfinfoexe':$2=this.get_$1_15();break;case 'install-mudraw-exe':$2=this.get_$1_19();break;default:return;}if($2){return;}var $3=$0.val();$2=!String.isNullOrEmpty($3);var $4=new afung.MangaWeb3.Common.CheckOtherComponentRequest();$4.path=$3;switch($1){case 'install-sevenzip-dll':this.set_$1_11($2);this.set_$1_13(false);$4.component=0;$('#install-sevenzip-error').remove();break;case 'install-pdfinfoexe':this.set_$1_15($2);this.set_$1_17(false);$4.component=1;$('#install-pdfinfoexe-error').remove();break;case 'install-mudraw-exe':this.set_$1_19($2);this.set_$1_1B(false);$4.component=2;$('#install-mudraw-error').remove();break;default:return;}if(!$2){return;}this.$1_1C=$4.component;afung.MangaWeb3.Client.Request.send($4,ss.Delegate.create(this,this.$1_1E),ss.Delegate.create(this,this.$1_1F));},$1_1E:function($p0){if($p0.pass){switch(this.$1_1C){case 0:this.set_$1_11(false);this.set_$1_13(true);break;case 1:this.set_$1_15(false);this.set_$1_17(true);break;case 2:this.set_$1_19(false);this.set_$1_1B(true);break;default:return;}}else{this.$1_1F();}},$1_1F:function(){switch(this.$1_1C){case 0:this.set_$1_13(this.set_$1_11(false));afung.MangaWeb3.Client.Template.get('install','install-sevenzip-error').appendTo($('#sevenzip-error-area'));break;case 1:this.set_$1_17(this.set_$1_15(false));afung.MangaWeb3.Client.Template.get('install','install-pdfinfoexe-error').appendTo($('#pdfinfo-error-area'));break;case 2:this.set_$1_1B(this.set_$1_19(false));afung.MangaWeb3.Client.Template.get('install','install-mudraw-error').appendTo($('#mudraw-error-area'));break;default:return;}},$1_20:function($p0){var $0=new RegExp('[^a-zA-Z0-9]');var $1=$('#install-admin-username').val();if(!$1||$0.test($1)){$('#install-admin-username-check').hide();}else{$('#install-admin-username-check').show();}},$1_21:function($p0){if($('#install-admin-password').val().length>=8){$('#install-admin-password-check').show();}else{$('#install-admin-password-check').hide();}},$1_22:function($p0){if($('#install-admin-password2').val().length>=8&&$('#install-admin-password').val()===$('#install-admin-password2').val()){$('#install-admin-password2-check').show();}else{$('#install-admin-password2-check').hide();}},$1_23:function($p0){if(this.get_$1_9()||this.get_$1_11()||this.get_$1_15()||this.get_$1_19()){return;}if(!this.$1_6){afung.MangaWeb3.Client.Modal.ErrorModal.showError(afung.MangaWeb3.Client.Strings.get('MissingRequiredComponent'));return;}if(!this.get_$1_1()&&!this.get_$1_3()&&!this.get_$1_5()){afung.MangaWeb3.Client.Modal.ErrorModal.showError(afung.MangaWeb3.Client.Strings.get('NeedFileSupport'));return;}var $0=$('#install-admin-username').val();var $1=$('#install-admin-password').val();var $2=$('#install-admin-password2').val();var $3=new RegExp('[^a-zA-Z0-9]');if(!$0||$3.test($0)||$1.length<8||$1!==$2){afung.MangaWeb3.Client.Modal.ErrorModal.showError(afung.MangaWeb3.Client.Strings.get('AdminUserSettingFailed'));return;}var $4=new afung.MangaWeb3.Common.InstallRequest();$4.mysqlServer=$('#install-mysql-server').val();$4.mysqlPort=parseInt($('#install-mysql-port').val(),10);$4.mysqlUser=$('#install-mysql-username').val();$4.mysqlPassword=$('#install-mysql-password').val();$4.mysqlDatabase=$('#install-mysql-database').val();$4.sevenZipPath=$('#install-sevenzip-dll').val();$4.pdfinfoPath=$('#install-pdfinfoexe').val();$4.mudrawPath=$('#install-mudraw-exe').val();$4.zip=$('#install-zip-checkbox').attr(afung.MangaWeb3.Client.HtmlConstants.attributeChecked)===afung.MangaWeb3.Client.HtmlConstants.attributeChecked;$4.rar=$('#install-rar-checkbox').attr(afung.MangaWeb3.Client.HtmlConstants.attributeChecked)===afung.MangaWeb3.Client.HtmlConstants.attributeChecked;$4.pdf=$('#install-pdf-checkbox').attr(afung.MangaWeb3.Client.HtmlConstants.attributeChecked)===afung.MangaWeb3.Client.HtmlConstants.attributeChecked;$4.admin=$0;$4.password=$1;$4.password2=$2;new afung.MangaWeb3.Client.Install.Modal.InstallingModal($4);}}
afung.MangaWeb3.Client.Install.InstallApp.registerClass('afung.MangaWeb3.Client.Install.InstallApp',afung.MangaWeb3.Client.Application);afung.MangaWeb3.Client.Install.Modal.InstallingModal.registerClass('afung.MangaWeb3.Client.Install.Modal.InstallingModal',afung.MangaWeb3.Client.Modal.ModalBase);afung.MangaWeb3.Client.Install.Module.InstallModule.registerClass('afung.MangaWeb3.Client.Install.Module.InstallModule',afung.MangaWeb3.Client.Module.ModuleBase);})();// This script was generated using Script# v0.7.4.0
